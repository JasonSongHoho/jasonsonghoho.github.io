<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="cassandra,kairosdb,jmeter," />





  <link rel="alternate" href="/atom.xml" title="jason's blog" type="application/atom+xml" />






<meta name="description" content="*本文是从公司内网KB转过来的，格式有点混乱懒得改了QAZ~~  目录 (Table of Contents) FAQ 一、测试目的 二、测试环境 三、测试方法 四、测试结果 写: 读：   五、结论 1、指标库写性能： 2、指标库读性能：    FAQ 1.写入能力：多少个15秒监控周期的主机，或180秒监控周期的网络设备的数据写入假设现场1个资源每15 S上报100个指标，则每分钟上报400个">
<meta name="keywords" content="cassandra,kairosdb,jmeter">
<meta property="og:type" content="article">
<meta property="og:title" content="产品性能自测">
<meta property="og:url" content="https://jasonsonghoho.github.io/2017/12/10/171210/index.html">
<meta property="og:site_name" content="jason&#39;s blog">
<meta property="og:description" content="*本文是从公司内网KB转过来的，格式有点混乱懒得改了QAZ~~  目录 (Table of Contents) FAQ 一、测试目的 二、测试环境 三、测试方法 四、测试结果 写: 读：   五、结论 1、指标库写性能： 2、指标库读性能：    FAQ 1.写入能力：多少个15秒监控周期的主机，或180秒监控周期的网络设备的数据写入假设现场1个资源每15 S上报100个指标，则每分钟上报400个">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/kairosdb_metric_count.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/kairosdb_metric_count_70W_75W.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/统计局_query_row_count2.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/统计局_query_sample_size.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/统计局_query_row_count.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/image2017-12-8_11_24_9.png">
<meta property="og:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/kairosdb.datastore.queries_waiting.png">
<meta property="og:updated_time" content="2018-09-20T15:09:08.600Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="产品性能自测">
<meta name="twitter:description" content="*本文是从公司内网KB转过来的，格式有点混乱懒得改了QAZ~~  目录 (Table of Contents) FAQ 一、测试目的 二、测试环境 三、测试方法 四、测试结果 写: 读：   五、结论 1、指标库写性能： 2、指标库读性能：    FAQ 1.写入能力：多少个15秒监控周期的主机，或180秒监控周期的网络设备的数据写入假设现场1个资源每15 S上报100个指标，则每分钟上报400个">
<meta name="twitter:image" content="https://jasonsonghoho.github.io/2017/12/10/171210/kairosdb_metric_count.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jasonsonghoho.github.io/2017/12/10/171210/"/>





  <title>产品性能自测 | jason's blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?72b386cef7d7f109725797247e159526";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jason's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonsonghoho.github.io/2017/12/10/171210/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jason song">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jason's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">产品性能自测</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-10T22:08:41+08:00">
                2017-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/12/10/171210/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2017/12/10/171210/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>*本文是从公司内网KB转过来的，格式有点混乱懒得改了QAZ~~</p>
<h2 id="目录-Table-of-Contents"><a href="#目录-Table-of-Contents" class="headerlink" title=" 目录 (Table of Contents)"></a> <strong>目录 (Table of Contents)</strong></h2><ul>
<li>FAQ</li>
<li>一、测试目的</li>
<li>二、测试环境</li>
<li>三、测试方法</li>
<li>四、测试结果<ul>
<li>写:</li>
<li>读：</li>
</ul>
</li>
<li>五、结论<ul>
<li>1、指标库写性能：</li>
<li>2、指标库读性能：</li>
</ul>
</li>
</ul>
<p></p><h2 id="id-指标库性能测试-FAQ">FAQ</h2><p></p>
<p><strong>1.写入能力：多少个15秒监控周期的主机，或180秒监控周期的网络设备的数据写入</strong></p><br><p style="margin-left: 30.0px;">假设现场1个资源每15 S上报100个指标，则每分钟上报400个，</p><br><p style="margin-left: 30.0px;">若部署单节点Cassandra，在redis集群状况良好的情况下，每分钟可写入80W个指标，可支持800000/400=2000个资源左右;</p><br><p style="margin-left: 30.0px;">若部署Cassandra 集群，每分钟可写入110W个指标，可支持1100000/400=2750个资源左右;</p><br><p style="margin-left: 30.0px;">考虑到稳定性可酌情减少资源量或增加配置。</p><br><p><strong>2.读出能力：每秒完成指定数据点数查询的TPS性能峰值，以便预测可以支持什么数量的仪表盘</strong></p><br><p style="margin-left: 30.0px;">在三台4C*16G的Cassandra节点的配置下，稳定查询的前提下，每分钟至少400条并发请求（每条请求至少6000条元数据，大约为15分钟的数据）。</p><br><p style="margin-left: 30.0px;"></p><br><p></p><br><p></p><br><p></p><br><h2 id="id-指标库性能测试-一、测试目的">一、测试目的</h2><br><p>测试在指定硬件条件下，指标库写入能力与读取能力。</p><br><h2 id="id-指标库性能测试-二、测试环境">二、测试环境</h2><br><div class="table-wrap"><br>    <table class="confluenceTable"><br>        <tbody><br>        <tr><br>            <th class="confluenceTh">ip</th><br>            <th colspan="1" class="confluenceTh">cpu</th><br>            <th class="confluenceTh">内存</th><br>            <th colspan="1" class="confluenceTh">磁盘</th><br>            <th colspan="1" class="confluenceTh">用途</th><br>            <th colspan="1" class="confluenceTh">备注</th><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd">个人电脑</td><br>            <td colspan="1" class="confluenceTd">4核</td><br>            <td colspan="1" class="confluenceTd">16G</td><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd"><span>部署jmeter</span></td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd"><span>10.1.53.37</span></td><br>            <td colspan="1" class="confluenceTd">6<span>核</span></td><br>            <td colspan="1" class="confluenceTd">8G</td><br>            <td colspan="1" class="confluenceTd"></td><br>            <td rowspan="4" class="confluenceTd">部署jmeter-server</td><br>            <td rowspan="4" class="confluenceTd"><p><span>通过jmeter来发送测试请求，</span></p><br>                <p>这些机器同时部署着其他产品。<br><br></p></td><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd"><span>10.1.53.38</span></td><br>            <td colspan="1" class="confluenceTd"><span>4核</span></td><br>            <td colspan="1" class="confluenceTd">16G</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd"><span>10.1.53.65</span></td><br>            <td colspan="1" class="confluenceTd"><span>4核</span></td><br>            <td colspan="1" class="confluenceTd"><span>8G</span></td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd"><span>10.1.61.10</span></td><br>            <td colspan="1" class="confluenceTd"><span>4核</span></td><br>            <td colspan="1" class="confluenceTd">24G</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <td colspan="1" class="confluenceTd">10.1.53.39</td><br>            <td colspan="1" class="confluenceTd"><span>4核</span></td><br>            <td colspan="1" class="confluenceTd">16G</td><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">指标库、ES、租户等组件</td><br>            <td colspan="1" class="confluenceTd">该机器主要用来部署指标库</td><br>        </tr><br>        <tr><br>            <td class="confluenceTd">10.1.61.117</td><br>            <td colspan="1" class="confluenceTd">4核</td><br>            <td class="confluenceTd">16G</td><br>            <td colspan="1" class="confluenceTd">38G</td><br>            <td colspan="1" class="confluenceTd">kairosdb、omp等</td><br>            <td colspan="1" class="confluenceTd"><span>kairosdb 堆内存为默认的3g</span></td><br>        </tr><br>        <tr><br>            <td class="confluenceTd">10.1.61.118</td><br>            <td colspan="1" class="confluenceTd">4核</td><br>            <td class="confluenceTd">16G</td><br>            <td colspan="1" class="confluenceTd">38G</td><br>            <td colspan="1" class="confluenceTd">Cassandra</td><br>            <td colspan="1" class="confluenceTd"><p><span>kairosdb 堆内存为<span>为默认的4</span>g，</span></p><br>                <p>计算公式 max(min(1/2 ram, 1024MB),min(1/4 ram, 8GB))</p></td><br>        </tr><br>        </tbody><br>    </table><br></div><br><p></p><br><h2 id="id-指标库性能测试-三、测试方法">三、测试方法</h2><br><p>测试工具为Jmeter，通过调用指标库相应的openApi测试，用jconsole 监控进程占用资源变化。</p><br><h2 id="id-指标库性能测试-四、测试结果">四、测试结果</h2><h4 id="id-指标库性能测试-写:">写:</h4><br><p style="margin-left: 30.0px;"><span>Ramp-up Period <span>决定多长时间启动所有线程。如果使用10个线程，ramp-up period是100秒，那么JMeter用100秒使所有10个线程启动并运行。每个线程会在上一个线程启动后10秒（100/10）启动。</span></span><br></p><br><p style="margin-left: 30.0px;">monitor 指标上报的频率是15S一次，故此处从 以15S/s 的频率启动一个上报线程开始测试。</p><br><p style="margin-left: 30.0px;">如组1，测试逻辑为：</p><br><p style="margin-left: 60.0px;">每15秒启动一个线程，单个线程每次上报25个指标，重复上报500次，每分钟指标写入请求次数为5W条。</p><br><p style="margin-left: 60.0px;">jmeter-server为1，表示只在本机运行测试；若为4，表示在4个机器上同时对指标库发起请求测试。</p><br><p style="margin-left: 30.0px;"></p><br><div class="table-wrap"><br>    <table class="confluenceTable"><br>        <tbody><br>        <tr><br>            <th rowspan="2" class="confluenceTh">组别</th><br>            <th colspan="6" style="text-align: center;" class="confluenceTh">条件</th><br>            <th colspan="8" style="text-align: center;" class="confluenceTh">jmeter 运行结果</th><br>            <th colspan="2" class="confluenceTh">指标库 统计日志</th><br>            <th colspan="2" class="confluenceTh">kairosdb 资源消耗</th><br>            <th colspan="2" class="confluenceTh"><span>Cassandra资源消耗</span><span> </span></th><br>            <th rowspan="2" style="text-align: center;" class="confluenceTh">备注</th><br>        </tr><br>        <tr><br>            <th class="confluenceTh">线程数（单个<span style="color: rgb(0,0,0);">jmeter-server</span>）</th><br>            <th class="confluenceTh">Ramp-up Period（in seconds）</th><br>            <th colspan="1" class="confluenceTh"><span>指标数</span></th><br>            <th class="confluenceTh">循环次数</th><br>            <th colspan="1" class="confluenceTh"><span>jmeter-server</span></th><br>            <th colspan="1" class="confluenceTh">每分钟请求次数（W）</th><br>            <th colspan="1" class="confluenceTh">samples(W)</th><br>            <th class="confluenceTh">avg(ms)</th><br>            <th colspan="1" class="confluenceTh">p90(ms)</th><br>            <th colspan="1" class="confluenceTh">p95(ms)</th><br>            <th class="confluenceTh">min(ms)</th><br>            <th class="confluenceTh">max(ms)</th><br>            <th colspan="1" class="confluenceTh">Error (%)</th><br>            <th class="confluenceTh">throughput<br> （吞吐量,sec）</th><br>            <th colspan="1" class="confluenceTh"><span>每分钟</span><span>最大可</span><span>写入数据量</span></th><br>            <th colspan="1" class="confluenceTh">avg(ms)</th><br>            <th class="confluenceTh">cpu(%,单个)</th><br>            <th class="confluenceTh">堆内存</th><br>            <th class="confluenceTh">cpu(%,单个)</th><br>            <th class="confluenceTh">堆内存</th><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">1</th><br>            <td colspan="1" class="confluenceTd">40</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd"><span>50</span></td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">212</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">810.0905</td><br>            <th colspan="1" class="confluenceTh"><span>50608</span></th><br>            <td colspan="1" class="confluenceTd">0.03</td><br>            <td colspan="1" class="confluenceTd"><span>2.2</span></td><br>            <td colspan="1" class="confluenceTd">501.2m</td><br>            <td colspan="1" class="confluenceTd">1.0</td><br>            <td colspan="1" class="confluenceTd">801.5m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">2</th><br>            <td colspan="1" class="confluenceTd">40</td><br>            <td colspan="1" class="confluenceTd"><span>600</span></td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">2500</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd"><span>250</span></td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1207</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">3363.239</td><br>            <th colspan="1" class="confluenceTh">256582</th><br>            <td colspan="1" class="confluenceTd">0.03</td><br>            <td colspan="1" class="confluenceTd">11.0</td><br>            <td colspan="1" class="confluenceTd">817.6m</td><br>            <td colspan="1" class="confluenceTd">6.0</td><br>            <td colspan="1" class="confluenceTd"><span>979.3m</span></td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">3</th><br>            <td colspan="1" class="confluenceTd">40</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">5000</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd"><span>50</span></td><br>            <td colspan="1" class="confluenceTd"><span>500</span></td><br>            <td colspan="1" class="confluenceTd">3</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">7</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1208</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">4958.901</td><br>            <th colspan="1" class="confluenceTh">403887</th><br>            <td colspan="1" class="confluenceTd">0.04</td><br>            <td colspan="1" class="confluenceTd">16.7</td><br>            <td colspan="1" class="confluenceTd">981.3m</td><br>            <td colspan="1" class="confluenceTd">8.5</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">4</th><br>            <td colspan="1" class="confluenceTd">40</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">7500</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">75</td><br>            <td colspan="1" class="confluenceTd">750</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">6</td><br>            <td colspan="1" class="confluenceTd">7</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">228</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">5591.89</td><br>            <th colspan="1" class="confluenceTh">438234</th><br>            <td colspan="1" class="confluenceTd">0.06</td><br>            <td colspan="1" class="confluenceTd">15.3</td><br>            <td colspan="1" class="confluenceTd">1.5g</td><br>            <td colspan="1" class="confluenceTd">7.2</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">5</th><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">10000</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">207</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">3828.079</td><br>            <th colspan="1" class="confluenceTh">346690</th><br>            <td colspan="1" class="confluenceTd">0.04</td><br>            <td colspan="1" class="confluenceTd">13.3</td><br>            <td colspan="1" class="confluenceTd">1.6g</td><br>            <td colspan="1" class="confluenceTd">7.2</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">6</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">6</td><br>            <td colspan="1" class="confluenceTd">9</td><br>            <td colspan="1" class="confluenceTd">11</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">408</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">7547.614</td><br>            <th colspan="1" class="confluenceTh">493742</th><br>            <td colspan="1" class="confluenceTd">0.09</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">9.8</td><br>            <td colspan="1" class="confluenceTd">1.9g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">7</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">700</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">70</td><br>            <td colspan="1" class="confluenceTd">700</td><br>            <td colspan="1" class="confluenceTd">17</td><br>            <td colspan="1" class="confluenceTd">28</td><br>            <td colspan="1" class="confluenceTd">32</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">309</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">7995.924</td><br>            <th colspan="1" class="confluenceTh">518429</th><br>            <td colspan="1" class="confluenceTd">0.54</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">11.7</td><br>            <td colspan="1" class="confluenceTd">2.1g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">8</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">125</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">10</td><br>            <td colspan="1" class="confluenceTd">16</td><br>            <td colspan="1" class="confluenceTd">18</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1019</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8022.193</td><br>            <th colspan="1" class="confluenceTh">497440</th><br>            <td colspan="1" class="confluenceTd">0.26</td><br>            <td colspan="1" class="confluenceTd">16.1</td><br>            <td colspan="1" class="confluenceTd">1.6g</td><br>            <td colspan="1" class="confluenceTd">10.2</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">9</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">1000</td><br>            <td colspan="1" class="confluenceTd">97</td><br>            <td colspan="1" class="confluenceTd">152</td><br>            <td colspan="1" class="confluenceTd">161</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">7627</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8216.643</td><br>            <th colspan="1" class="confluenceTh">530591</th><br>            <td colspan="1" class="confluenceTd">0.72</td><br>            <td colspan="1" class="confluenceTd">20.1</td><br>            <td colspan="1" class="confluenceTd"><span>2.0g</span></td><br>            <td colspan="1" class="confluenceTd">20.4</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">10</th><br>            <td colspan="1" class="confluenceTd"><span>800</span></td><br>            <td colspan="1" class="confluenceTd"><span>600</span></td><br>            <td colspan="1" class="confluenceTd"><span>25</span></td><br>            <td colspan="1" class="confluenceTd"><span>125</span></td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">1000</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">161</td><br>            <td colspan="1" class="confluenceTd">171</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1177</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">7972.218</td><br>            <th colspan="1" class="confluenceTh">529113</th><br>            <td colspan="1" class="confluenceTd">0.70</td><br>            <td colspan="1" class="confluenceTd">21.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">10.8</td><br>            <td colspan="1" class="confluenceTd">2.2g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">11</th><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">1000</td><br>            <td colspan="1" class="confluenceTd">49</td><br>            <td colspan="1" class="confluenceTd">76</td><br>            <td colspan="1" class="confluenceTd">82</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1095</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8219.331</td><br>            <th colspan="1" class="confluenceTh">516068</th><br>            <td colspan="1" class="confluenceTd">0.74</td><br>            <td colspan="1" class="confluenceTd">21.5</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">10.5</td><br>            <td colspan="1" class="confluenceTd">2.2g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">12</th><br>            <td colspan="1" class="confluenceTd"><span>400</span></td><br>            <td colspan="1" class="confluenceTd"><span>600</span></td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">1000</td><br>            <td colspan="1" class="confluenceTd">98</td><br>            <td colspan="1" class="confluenceTd">150</td><br>            <td colspan="1" class="confluenceTd">159</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1188</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8235.625</td><br>            <th colspan="1" class="confluenceTh">504438</th><br>            <td colspan="1" class="confluenceTd">0.78</td><br>            <td colspan="1" class="confluenceTd">22.6</td><br>            <td colspan="1" class="confluenceTd">2.1g</td><br>            <td colspan="1" class="confluenceTd">23.8</td><br>            <td colspan="1" class="confluenceTd">2.3g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">13</th><br>            <td colspan="1" class="confluenceTd"><span>2400</span></td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">3870</td><br>            <td colspan="1" class="confluenceTd">204</td><br>            <td colspan="1" class="confluenceTd">268</td><br>            <td colspan="1" class="confluenceTd">286</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">7723</td><br>            <td colspan="1" class="confluenceTd">2.55%</td><br>            <td colspan="1" class="confluenceTd">8890.767</td><br>            <th colspan="1" class="confluenceTh">545621</th><br>            <td colspan="1" class="confluenceTd">0.76</td><br>            <td colspan="1" class="confluenceTd">23.1</td><br>            <td colspan="1" class="confluenceTd">2.1g</td><br>            <td colspan="1" class="confluenceTd">20.5</td><br>            <td colspan="1" class="confluenceTd">2.5g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">14</th><br>            <td colspan="1" class="confluenceTd"><span>120</span></td><br>            <td colspan="1" class="confluenceTd"><span>600</span></td><br>            <td colspan="1" class="confluenceTd"><span>25</span></td><br>            <td colspan="1" class="confluenceTd">800</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd"><span><span>96</span></span></td><br>            <td colspan="1" class="confluenceTd">960</td><br>            <td colspan="1" class="confluenceTd">27</td><br>            <td colspan="1" class="confluenceTd">44</td><br>            <td colspan="1" class="confluenceTd">49</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1052</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8504.614</td><br>            <th colspan="1" class="confluenceTh">493434</th><br>            <td colspan="1" class="confluenceTd">0.77</td><br>            <td colspan="1" class="confluenceTd">20.1</td><br>            <td colspan="1" class="confluenceTd">1.1g</td><br>            <td colspan="1" class="confluenceTd">12.2</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">15</th><br>            <td colspan="1" class="confluenceTd">720</td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">800</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd"><span>960</span></td><br>            <td colspan="1" class="confluenceTd">5730</td><br>            <td colspan="1" class="confluenceTd">146</td><br>            <td colspan="1" class="confluenceTd">230</td><br>            <td colspan="1" class="confluenceTd">242</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">3087</td><br>            <td colspan="1" class="confluenceTd">0.02%</td><br>            <td colspan="1" class="confluenceTd">8765.976</td><br>            <th colspan="1" class="confluenceTh">556782</th><br>            <td colspan="1" class="confluenceTd">0.71</td><br>            <td colspan="1" class="confluenceTd">22.5</td><br>            <td colspan="1" class="confluenceTd">1.6g</td><br>            <td colspan="1" class="confluenceTd">25.1</td><br>            <td colspan="1" class="confluenceTd">2.5g</td><br>            <td colspan="1" class="confluenceTd">注：【1】</td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">16</th><br>            <td class="confluenceTd">9600</td><br>            <td class="confluenceTd">14400</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">5289</td><br>            <td colspan="1" class="confluenceTd">15751</td><br>            <td colspan="1" class="confluenceTd">127216</td><br>            <td colspan="1" class="confluenceTd">127232</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">306493</td><br>            <td colspan="1" class="confluenceTd">11.61%</td><br>            <td colspan="1" class="confluenceTd">999.4154</td><br>            <th colspan="1" class="confluenceTh">533848</th><br>            <td colspan="1" class="confluenceTd">0.65</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd"><p>2.0g</p></td><br>            <td colspan="1" class="confluenceTd"><span>注：【2】</span></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">17</th><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">25</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">3000</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">54</td><br>            <td colspan="1" class="confluenceTd">61</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">1068</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">8180.800</td><br>            <th colspan="1" class="confluenceTh">517877</th><br>            <td colspan="1" class="confluenceTd">0.77</td><br>            <td colspan="1" class="confluenceTd"><span>20.0</span></td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd"><p>2.0g</p></td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">18</th><br>            <td colspan="1" class="confluenceTd">2880</td><br>            <td colspan="1" class="confluenceTd">14400</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">9</td><br>            <td colspan="1" class="confluenceTd">17</td><br>            <td colspan="1" class="confluenceTd">23<br><br>                <p></p></td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">3010</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd"><p><span>9822.518</span></p></td><br>            <th colspan="1" class="confluenceTh">612078</th><br>            <td colspan="1" class="confluenceTd">26.91</td><br>            <td colspan="1" class="confluenceTd">15.0</td><br>            <td colspan="1" class="confluenceTd">1.8g</td><br>            <td colspan="1" class="confluenceTd">32.0</td><br>            <td colspan="1" class="confluenceTd">2.5g</td><br>            <td colspan="1" class="confluenceTd">多gateway 模块、</td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">19</th><br>            <td colspan="1" class="confluenceTd">240</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">50</td><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">12000000</td><br>            <td colspan="1" class="confluenceTd">15</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">39</td><br>            <td colspan="1" class="confluenceTd">0</td><br>            <td colspan="1" class="confluenceTd">3029</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">15974.696</td><br>            <th colspan="1" class="confluenceTh">1109678</th><br>            <td colspan="1" class="confluenceTd">15.70</td><br>            <td colspan="1" class="confluenceTd">22.0</td><br>            <td colspan="1" class="confluenceTd">0.8g</td><br>            <td colspan="1" class="confluenceTd">13.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd">多指标库、Cassandra集群</td><br>        </tr><br>        </tbody><br>    </table><br></div><br><p></p><br><p></p><br><p style="margin-left: 30.0px;">1.kairosdb 自带写入统计指标：</p><br><p style="margin-left: 60.0px;">kairosdb.metric_counters - Counts the number of data points received since the last<br>    report. Tags are used to separate one metric from another.（统计自上次上报后接收的数据量。标签用于区分指标。）</p><br><p style="margin-left: 60.0px;"></p><br><p style="margin-left: 30.0px;">kairosdb 统计结果：</p><br><p style="margin-left: 30.0px;"><br><img src="/2017/12/10/171210/kairosdb_metric_count.png"><br><br></p><br><p style="margin-left: 30.0px;">“1”处为组别12的测试结果，“2”处为直接调用kairosdb restApi 写入接口，“3”处为组别14 的结果。结果与指标库的统计日志一致。<br><br></p><p style="margin-left: 30.0px;">2.时间有限，每组测试时间间隔较短，因此可能会对CPU、内存以及Cassandra状态产生影响，使结果不够准确。</p><br><p style="margin-left: 30.0px;"></p><br><p style="margin-left: 30.0px;"><strong>注：</strong></p><br><p style="margin-left: 30.0px;">【1】：指标库redis 报内存不够，异常： Can’t save in background: fork: Cannot allocate memory</p><br><p style="margin-left: 30.0px;">【2】：<span style="background-color: transparent;">短时间插入大量指标会导致未压实的sstable数据太多，压实进程报可用磁盘空间不足，重新压实…恶性循环。</span><br></p><br><p style="margin-left: 30.0px;"><span style="background-color: transparent;"><br></span></p><br><div class="code panel pdl" style="border-width: 1px;"><br>    <div class="codeContent panelContent pdl"><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;![CDATA[[root@localhost data_points-1e09be40c3c811e7977aa147ea7baf03]# /opt/cassandra/bin/nodetool compactionstats -H</span><br><span class="line">pending tasks: 2</span><br><span class="line">- kairosdb.data_points: 2</span><br><span class="line">id                                   compaction type keyspace table       completed total    unit  progress</span><br><span class="line">ef340e00-d4d8-11e7-a239-0d717928a22e Compaction      kairosdb data_points 6.23 GB   11.42 GB bytes 54.56%</span><br><span class="line">Active compaction remaining time :   0h05m32s</span><br><span class="line">]]&gt;</span><br></pre></td></tr></table></figure><br><br>    </div><br></div><br><p style="margin-left: 30.0px;"><span><br></span></p><br><p style="margin-left: 30.0px;"><span>Cassandra报异常:</span></p><br><div class="code panel pdl" style="border-width: 1px;"><br>    <div class="codeContent panelContent pdl"><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;![CDATA[WARN  [CompactionExecutor:46] 2017-11-28 22:26:29,785 CompactionTask.java:91 - insufficient space to compact all requested files BigTableReader(path=&amp;#39;/opt/dbdata/cassandra/data/kairosdb/data_points-1e09be40c3c811e7977aa147ea7baf03/ma-216-big-Data.db&amp;#39;), BigTableReader(path=&amp;#39;/opt/dbdata/cassandra/data/kairosdb/data_points-1e09be40c3c811e7977aa147ea7baf03/ma-237-big-Data.db&amp;#39;)</span><br><span class="line">ERROR [CompactionExecutor:46] 2017-11-28 22:26:29,827 CassandraDaemon.java:195 - Exception in thread Thread[CompactionExecutor:46,1,main]</span><br><span class="line">java.lang.RuntimeException: Not enough space for compaction, estimated sstables = 1, expected write size = 2395303467</span><br><span class="line">	at org.apache.cassandra.db.compaction.CompactionTask.checkAvailableDiskSpace(CompactionTask.java:278) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at org.apache.cassandra.db.compaction.CompactionTask.runMayThrow(CompactionTask.java:126) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:82) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionCandidate.run(CompactionManager.java:264) ~[apache-cassandra-3.5.jar:3.5]</span><br><span class="line">	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_144]</span><br><span class="line">	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_144]</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8.0_144]</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_144]</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144]</span><br><span class="line"></span><br><span class="line">]]&gt;</span><br></pre></td></tr></table></figure><br><br>    </div><br></div><br><p></p><br><p style="margin-left: 30.0px;">解决方法：</p><br><p style="margin-left: 60.0px;">1、增大磁盘空间、</p><br><p style="margin-left: 60.0px;">2、直接删除同一编号的sstable 大文件</p><br><p style="margin-left: 60.0px;">3、重装Cassandra</p><h4 id="id-指标库性能测试-多节点写:">多节点写:</h4><br><p style="margin-left: 30.0px;">1.通过观察发现，写的瓶颈在指标库的gateway，然后增加多节点的测试如下：</p><br><ul><br>    <li style="margin-left: 30.0px;">开启一个gateway、一个writer模块后，指标写入能力在 <strong>50W/分钟</strong>；</li><br>    <li style="margin-left: 30.0px;">开启三个gateway、一个writer模块后，指标写入能力在 <strong>80W/分钟</strong>；</li><br>    <li style="margin-left: 30.0px;">开启三个三个gateway、三个writer 模块后，指标写入能力在 <strong>85W/分钟</strong>。</li><br></ul><br><br><p><br><img src="/2017/12/10/171210/kairosdb_metric_count_70W_75W.png"><br><br></p><p style="margin-left: 30.0px;">2.当部署Cassandra集群（3个节点）后，指标写入能力可以再次提升，<span style="background-color: transparent;">开启三个gateway、一个writer模块，指标写入能力在 <strong>100W/分钟</strong> ，此状态下可持续写入四个小时，期间redis会报内存不够的异常。</span><br></p>

&lt;p style=”margin-left: 30.0px; &gt;<br><br><br><p></p>

<p></p><p style="margin-left: 30.0px;"><span style="background-color: transparent;">另外，当指标库写入在满载的情况下，指标的读取能力会受到很大影响，且写入也会偶尔报连接超时现象。</span><br></p><p></p>
<p></p><p style="margin-left: 30.0px;"><span style="background-color: transparent;"><br></span></p><h4 id="id-指标库性能测试-读："><br>    读：</h4><p></p>
<p></p><p>指标的查询，其实是kairosdb去查Cassandra中数据。因此kairosdb查Cassandra的速度才是关键因素。而查Cassandra数据的速度，跟查询的Cassandra的row数量、元数据量等因素相关。</p><p></p>
<p></p><p>要模拟读取测试，就需要先调查现场实际查询的row和元数据大小。</p><p></p>
<p></p><p>统计局的统计如下：</p><p></p>
<p></p><p style="margin-left: 30.0px;">上图为密集查询30分钟内指标时，从Cassandra中查询的row的行数；</p><p></p>
<p></p><p style="margin-left: 30.0px;">中图为密集查询30分钟内指标时，从Cassandra中查询的元数据的数量；</p><p></p>
<p></p><p style="margin-left: 30.0px;">下图为定时查询时row的行数。</p><p></p>
<p>

</p><p></p><p></p>
<p></p><p style="margin-left: 30.0px;"><br><img src="/2017/12/10/171210/统计局_query_row_count2.png"></p>
<p></p><p></p>
<p></p><p style="margin-left: 30.0px;"></p><p></p>
<p></p><p style="margin-left: 30.0px;"><br><img src="/2017/12/10/171210/统计局_query_sample_size.png"></p>
<p></p><p></p>
<p></p><p style="margin-left: 30.0px;"></p><p></p>
<p></p><p style="margin-left: 30.0px;"><br><img src="/2017/12/10/171210/统计局_query_row_count.png"></p>
<p></p><p></p>
<p></p><p style="margin-left: 30.0px;"></p><p></p>
<p></p><p style="margin-left: 30.0px;"></p><p></p>
<p></p><p style="margin-left: 30.0px;">可以看出：</p><p></p>
<p></p><p style="margin-left: 30.0px;">密集查询时，row最大的在4000，大部分比较小，接近1。定时查询时，row在100行以下。</p><p></p>
<p></p><p style="margin-left: 30.0px;">现场400个设备，查询30分钟指标时，理论上应该有大约400<em>4</em>30=48000 的元数据，实际查询时，要小于该值。基本都在几百条。</p><p></p>
<p></p><p></p><p></p>
<p></p><p></p><p></p>
<p><div class="table-wrap"><br>    <table class="confluenceTable"><br>        <tbody><br>        <tr><br>            <th rowspan="2" class="confluenceTh">组别</th><br>            <th colspan="9" style="text-align: center;" class="confluenceTh">条件</th><br>            <th colspan="8" style="text-align: center;" class="confluenceTh">jmeter 运行结果</th><br>            <th colspan="3" style="text-align: center;" class="confluenceTh">kairosdb 统计指标</th><br>            <th colspan="2" class="confluenceTh">kairosdb 资源消耗</th><br>            <th colspan="2" class="confluenceTh">Cassandra资源消耗</th><br>            <th rowspan="2" style="text-align: center;" class="confluenceTh">备注</th><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">额外条件</th><br>            <th class="confluenceTh">线程数（单个<span>jmeter-server</span>）</th><br>            <th class="confluenceTh">Ramp-up Period（in seconds）</th><br>            <th colspan="1" class="confluenceTh">指标数</th><br>            <th class="confluenceTh">循环次数</th><br>            <th colspan="1" class="confluenceTh">时间跨度（minute）</th><br>            <th colspan="1" class="confluenceTh">kairosdb httpClient max connection（R12为2）</th><br>            <th colspan="1" class="confluenceTh"><p>kairosdb concurrent</p><br>                <p>QueryThreads<span style="color: rgb(0,0,0);">（默认为5）</span></p></th><br>            <th colspan="1" class="confluenceTh">每分钟请求次数（个）</th><br>            <th colspan="1" class="confluenceTh">samples(W)</th><br>            <th class="confluenceTh">avg(ms)</th><br>            <th colspan="1" class="confluenceTh">p90(ms)</th><br>            <th colspan="1" class="confluenceTh">p95(ms)</th><br>            <th class="confluenceTh">min(ms)</th><br>            <th class="confluenceTh">max(ms)</th><br>            <th colspan="1" class="confluenceTh">Error (%)</th><br>            <th class="confluenceTh">throughput<br> （吞吐量,sec）</th><br>            <th colspan="1" class="confluenceTh"><span style="color: rgb(0,0,0);">query_row_count</span></th><br>            <th colspan="1" class="confluenceTh">query_sample_size</th><br>            <th colspan="1" class="confluenceTh">http.query_time(ms)</th><br>            <th class="confluenceTh">cpu(%,单个)</th><br>            <th class="confluenceTh">堆内存</th><br>            <th class="confluenceTh">cpu(%,单个)</th><br>            <th class="confluenceTh">堆内存</th><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">1</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">300</td><br>            <th colspan="1" class="confluenceTh">2050</th><br>            <td colspan="1" class="confluenceTd">2248</td><br>            <td colspan="1" class="confluenceTd">2354</td><br>            <td colspan="1" class="confluenceTd">2572</td><br>            <td colspan="1" class="confluenceTd">2662</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.50003</td><br>            <td colspan="1" class="confluenceTd">77</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2000</th><br>            <td colspan="1" class="confluenceTd">8.0</td><br>            <td colspan="1" class="confluenceTd">660m</td><br>            <td colspan="1" class="confluenceTd">15.0</td><br>            <td colspan="1" class="confluenceTd">500m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">2</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">10</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">6316</th><br>            <td colspan="1" class="confluenceTd">10091</td><br>            <td colspan="1" class="confluenceTd">10432</td><br>            <td colspan="1" class="confluenceTd">11112</td><br>            <td colspan="1" class="confluenceTd">12404</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.91546</td><br>            <td colspan="1" class="confluenceTd"><span>77</span></td><br>            <td colspan="1" class="confluenceTd"><span>600</span></td><br>            <th colspan="1" class="confluenceTh">2000</th><br>            <td colspan="1" class="confluenceTd">15.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd">26.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">3</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd"><span>60</span></td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">19714</th><br>            <td colspan="1" class="confluenceTd">31297</td><br>            <td colspan="1" class="confluenceTd">33088</td><br>            <td colspan="1" class="confluenceTd">39746</td><br>            <td colspan="1" class="confluenceTd">41845</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.85141</td><br>            <td colspan="1" class="confluenceTd">77</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2000</th><br>            <td colspan="1" class="confluenceTd">15.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">23.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">4</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd"><span>5</span></td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">12988</th><br>            <td colspan="1" class="confluenceTd">21422</td><br>            <td colspan="1" class="confluenceTd">22713</td><br>            <td colspan="1" class="confluenceTd">23753</td><br>            <td colspan="1" class="confluenceTd">25443</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.82763</td><br>            <td colspan="1" class="confluenceTd">77</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2000</th><br>            <td colspan="1" class="confluenceTd">15.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">23.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">5</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd"><span>60</span></td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd"><span>30</span></td><br>            <td colspan="1" class="confluenceTd">300</td><br>            <th colspan="1" class="confluenceTh">2304</th><br>            <td colspan="1" class="confluenceTd">2521</td><br>            <td colspan="1" class="confluenceTd">2665</td><br>            <td colspan="1" class="confluenceTd">3169</td><br>            <td colspan="1" class="confluenceTd">3459</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.49864</td><br>            <td colspan="1" class="confluenceTd">740</td><br>            <td colspan="1" class="confluenceTd">7200</td><br>            <th colspan="1" class="confluenceTh">2150</th><br>            <td colspan="1" class="confluenceTd">8.0</td><br>            <td colspan="1" class="confluenceTd">660m</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">6</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd"><span>60</span></td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">10</td><br>            <td colspan="1" class="confluenceTd">2</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd"><span>120</span></td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">6605</th><br>            <td colspan="1" class="confluenceTd">13772</td><br>            <td colspan="1" class="confluenceTd">24746</td><br>            <td colspan="1" class="confluenceTd">46642</td><br>            <td colspan="1" class="confluenceTd">60032</td><br>            <td colspan="1" class="confluenceTd">0.667%</td><br>            <td colspan="1" class="confluenceTd">1.62541</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">608</td><br>            <th colspan="1" class="confluenceTh">2770</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">7</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">15</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">90</td><br>            <td colspan="1" class="confluenceTd">900</td><br>            <th colspan="1" class="confluenceTh">3082</th><br>            <td colspan="1" class="confluenceTd">3489</td><br>            <td colspan="1" class="confluenceTd">4441</td><br>            <td colspan="1" class="confluenceTd">5580</td><br>            <td colspan="1" class="confluenceTd">6537</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.42068</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">35.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">600m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">8</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">6651</th><br>            <td colspan="1" class="confluenceTd">8944</td><br>            <td colspan="1" class="confluenceTd">12108</td><br>            <td colspan="1" class="confluenceTd">19296</td><br>            <td colspan="1" class="confluenceTd">51860</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.65295</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">9</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd"><span>120</span></td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">6818</th><br>            <td colspan="1" class="confluenceTd">8769</td><br>            <td colspan="1" class="confluenceTd">11503</td><br>            <td colspan="1" class="confluenceTd">23196</td><br>            <td colspan="1" class="confluenceTd">47418</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.6662</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">10</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">100</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">8673</th><br>            <td colspan="1" class="confluenceTd">11355</td><br>            <td colspan="1" class="confluenceTd">17379</td><br>            <td colspan="1" class="confluenceTd">35937</td><br>            <td colspan="1" class="confluenceTd">60045</td><br>            <td colspan="1" class="confluenceTd">0.33%</td><br>            <td colspan="1" class="confluenceTd">1.55826</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">11</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">9315</th><br>            <td colspan="1" class="confluenceTd">12913</td><br>            <td colspan="1" class="confluenceTd">18000</td><br>            <td colspan="1" class="confluenceTd">46211</td><br>            <td colspan="1" class="confluenceTd">60035</td><br>            <td colspan="1" class="confluenceTd">0.42%</td><br>            <td colspan="1" class="confluenceTd">1.53925</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">12</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">4</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">6297</th><br>            <td colspan="1" class="confluenceTd">8577</td><br>            <td colspan="1" class="confluenceTd">11401</td><br>            <td colspan="1" class="confluenceTd">20061</td><br>            <td colspan="1" class="confluenceTd">34485</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.68581</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2750</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">13</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">8</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">6519</th><br>            <td colspan="1" class="confluenceTd">8786</td><br>            <td colspan="1" class="confluenceTd">12346</td><br>            <td colspan="1" class="confluenceTd">21569</td><br>            <td colspan="1" class="confluenceTd">37266</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.65904</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2750</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">14</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">1440</td><br>            <td colspan="1" class="confluenceTd">14400</td><br>            <td colspan="1" class="confluenceTd">10</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">14400</td><br>            <th colspan="1" class="confluenceTh">2235</th><br>            <td colspan="1" class="confluenceTd">2415</td><br>            <td colspan="1" class="confluenceTd">2486</td><br>            <td colspan="1" class="confluenceTd">2672</td><br>            <td colspan="1" class="confluenceTd">3526</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">0.99918</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2200</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">900m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">15</th><br>            <td colspan="1" class="confluenceTd"></td><br>            <td colspan="1" class="confluenceTd">360</td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">15</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">90</td><br>            <td colspan="1" class="confluenceTd">5400</td><br>            <th colspan="1" class="confluenceTh">2845</th><br>            <td colspan="1" class="confluenceTd">3445</td><br>            <td colspan="1" class="confluenceTd">4141</td><br>            <td colspan="1" class="confluenceTd">5259</td><br>            <td colspan="1" class="confluenceTd">7660</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.48842</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh"><span>2800</span></th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">1.0g</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">1.4g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">16</th><br>            <td colspan="1" class="confluenceTd">指标库集群</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">8398</th><br>            <td colspan="1" class="confluenceTd">12253</td><br>            <td colspan="1" class="confluenceTd">17298</td><br>            <td colspan="1" class="confluenceTd">31302</td><br>            <td colspan="1" class="confluenceTd">57404</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.55219</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3000</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">1.0g</td><br>            <td colspan="1" class="confluenceTd">50.0</td><br>            <td colspan="1" class="confluenceTd">1.4g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">17</th><br>            <td rowspan="5" style="text-align: center;" class="confluenceTd">kairosdb 8核单台</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">3156</th><br>            <td colspan="1" class="confluenceTd">3143</td><br>            <td colspan="1" class="confluenceTd">3493</td><br>            <td colspan="1" class="confluenceTd">5072</td><br>            <td colspan="1" class="confluenceTd">5897</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.77654</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2700</th><br>            <td colspan="1" class="confluenceTd"><span>20.0(8核)</span></td><br>            <td colspan="1" class="confluenceTd"><span>800m</span></td><br>            <td colspan="1" class="confluenceTd">55.0</td><br>            <td colspan="1" class="confluenceTd">1.4g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">18</th><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">8</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">2847</th><br>            <td colspan="1" class="confluenceTd">3128</td><br>            <td colspan="1" class="confluenceTd">3473</td><br>            <td colspan="1" class="confluenceTd">5060</td><br>            <td colspan="1" class="confluenceTd">5811</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.87776</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2700</th><br>            <td colspan="1" class="confluenceTd">20.0(8核)</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">55.0</td><br>            <td colspan="1" class="confluenceTd">1.4g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">19</th><br>            <td colspan="1" class="confluenceTd">360</td><br>            <td colspan="1" class="confluenceTd">3600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">8</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">7200</td><br>            <th colspan="1" class="confluenceTh">2784</th><br>            <td colspan="1" class="confluenceTd">2980</td><br>            <td colspan="1" class="confluenceTd">3453</td><br>            <td colspan="1" class="confluenceTd">5109</td><br>            <td colspan="1" class="confluenceTd">5616</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.97834</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2700</th><br>            <td colspan="1" class="confluenceTd">20.0(8核)</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">60.0</td><br>            <td colspan="1" class="confluenceTd">1.7g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">20</th><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">8</td><br>            <td colspan="1" class="confluenceTd">180</td><br>            <td colspan="1" class="confluenceTd">1800</td><br>            <th colspan="1" class="confluenceTh">7512</th><br>            <td colspan="1" class="confluenceTd">10825</td><br>            <td colspan="1" class="confluenceTd">12394</td><br>            <td colspan="1" class="confluenceTd">23556</td><br>            <td colspan="1" class="confluenceTd">35315</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">2.19003</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3300</th><br>            <td colspan="1" class="confluenceTd">22.0(8核)</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">72.0</td><br>            <td colspan="1" class="confluenceTd">1.9g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">21</th><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">40</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">8</td><br>            <td colspan="1" class="confluenceTd">240</td><br>            <td colspan="1" class="confluenceTd">2235</td><br>            <th colspan="1" class="confluenceTh">10304</th><br>            <td colspan="1" class="confluenceTd">16749</td><br>            <td colspan="1" class="confluenceTd">28070</td><br>            <td colspan="1" class="confluenceTd">58301</td><br>            <td colspan="1" class="confluenceTd">60039</td><br>            <td colspan="1" class="confluenceTd">2.04%</td><br>            <td colspan="1" class="confluenceTd">1.93493</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3400</th><br>            <td colspan="1" class="confluenceTd">22.0<span>(8核)</span></td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">72.0</td><br>            <td colspan="1" class="confluenceTd">1.9g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">22</th><br>            <td rowspan="2" class="confluenceTd">kairosdb 集群（4C*2）</td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">2862</th><br>            <td colspan="1" class="confluenceTd">3670</td><br>            <td colspan="1" class="confluenceTd">4182</td><br>            <td colspan="1" class="confluenceTd">4817</td><br>            <td colspan="1" class="confluenceTd">6435</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">1.87606</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">2800</th><br>            <td colspan="1" class="confluenceTd">22.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">70.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">23</th><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">180</td><br>            <td colspan="1" class="confluenceTd">1800</td><br>            <th colspan="1" class="confluenceTh">7022</th><br>            <td colspan="1" class="confluenceTd">12305</td><br>            <td colspan="1" class="confluenceTd">14342</td><br>            <td colspan="1" class="confluenceTd">21109</td><br>            <td colspan="1" class="confluenceTd">37044</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">2.30583</td><br>            <td colspan="1" class="confluenceTd">80</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <th colspan="1" class="confluenceTh">3200</th><br>            <td colspan="1" class="confluenceTd">22.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">70.0</td><br>            <td colspan="1" class="confluenceTd">2.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">24</th><br>            <td rowspan="6" class="confluenceTd"><p>cassandra</p><br>                <p>集群</p><br>                <p></p></td><br>            <td colspan="1" class="confluenceTd">60</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">120</td><br>            <td colspan="1" class="confluenceTd">1200</td><br>            <th colspan="1" class="confluenceTh">154</th><br>            <td colspan="1" class="confluenceTd">163</td><br>            <td colspan="1" class="confluenceTd">169</td><br>            <td colspan="1" class="confluenceTd">186</td><br>            <td colspan="1" class="confluenceTd">3167</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">2.02311</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">604</td><br>            <th colspan="1" class="confluenceTh">140</th><br>            <td colspan="1" class="confluenceTd">3.0</td><br>            <td colspan="1" class="confluenceTd">200m</td><br>            <td colspan="1" class="confluenceTd">2.0</td><br>            <td colspan="1" class="confluenceTd">2.2g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">25</th><br>            <td colspan="1" class="confluenceTd">300</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">900</td><br>            <td colspan="1" class="confluenceTd">9000</td><br>            <th colspan="1" class="confluenceTh">181</th><br>            <td colspan="1" class="confluenceTd">204</td><br>            <td colspan="1" class="confluenceTd">212</td><br>            <td colspan="1" class="confluenceTd">235</td><br>            <td colspan="1" class="confluenceTd">435</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">14.91056</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">604</td><br>            <th colspan="1" class="confluenceTh">180</th><br>            <td colspan="1" class="confluenceTd">17.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">20.0</td><br>            <td colspan="1" class="confluenceTd">2.6g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">26</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">35</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1400</td><br>            <td colspan="1" class="confluenceTd"><span>14000</span></td><br>            <th colspan="1" class="confluenceTh">203</th><br>            <td colspan="1" class="confluenceTd">231</td><br>            <td colspan="1" class="confluenceTd">242</td><br>            <td colspan="1" class="confluenceTd">273</td><br>            <td colspan="1" class="confluenceTd">784</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">22.4491</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">604</td><br>            <th colspan="1" class="confluenceTh">193</th><br>            <td colspan="1" class="confluenceTd">25.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">1.0g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">27</th><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">30</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1500</td><br>            <td colspan="1" class="confluenceTd">15000</td><br>            <th colspan="1" class="confluenceTh">416</th><br>            <td colspan="1" class="confluenceTd">524</td><br>            <td colspan="1" class="confluenceTd">551</td><br>            <td colspan="1" class="confluenceTd">599</td><br>            <td colspan="1" class="confluenceTd">819</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">24.6827</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">601</td><br>            <th colspan="1" class="confluenceTh">197</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">33.0</td><br>            <td colspan="1" class="confluenceTd">1.4g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">28</th><br>            <td colspan="1" class="confluenceTd">700</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">1400</td><br>            <td colspan="1" class="confluenceTd"><span>14000</span></td><br>            <th colspan="1" class="confluenceTh">204</th><br>            <td colspan="1" class="confluenceTd">239</td><br>            <td colspan="1" class="confluenceTd">252</td><br>            <td colspan="1" class="confluenceTd">293</td><br>            <td colspan="1" class="confluenceTd">480</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">23.20079</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">601</td><br>            <th colspan="1" class="confluenceTh">199</th><br>            <td colspan="1" class="confluenceTd">28.0</td><br>            <td colspan="1" class="confluenceTd">700m</td><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">1.2g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">29</th><br>            <td colspan="1" class="confluenceTd">4800</td><br>            <td colspan="1" class="confluenceTd">7200</td><br>            <td colspan="1" class="confluenceTd">35</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd"><span>1400</span></td><br>            <td colspan="1" class="confluenceTd">168000</td><br>            <th colspan="1" class="confluenceTh">203</th><br>            <td colspan="1" class="confluenceTd">232</td><br>            <td colspan="1" class="confluenceTd">244</td><br>            <td colspan="1" class="confluenceTd">279</td><br>            <td colspan="1" class="confluenceTd">800</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">24.6765</td><br>            <td colspan="1" class="confluenceTd">69</td><br>            <td colspan="1" class="confluenceTd">604</td><br>            <th colspan="1" class="confluenceTh">180</th><br>            <td colspan="1" class="confluenceTd">28.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">1.2g</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">30</th><br>            <td rowspan="2" class="confluenceTd"><p>cassandra</p><br>                <p>集群，写入一段时间数据后。</p></td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">400</td><br>            <td colspan="1" class="confluenceTd">4000</td><br>            <th colspan="1" class="confluenceTh">675</th><br>            <td colspan="1" class="confluenceTd">760</td><br>            <td colspan="1" class="confluenceTd">791</td><br>            <td colspan="1" class="confluenceTd">871</td><br>            <td colspan="1" class="confluenceTd">1264</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">6.57273</td><br>            <td colspan="1" class="confluenceTd">70</td><br>            <td colspan="1" class="confluenceTd">605</td><br>            <th colspan="1" class="confluenceTh">641</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">500m</td><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        <tr><br>            <th colspan="1" class="confluenceTh">31</th><br>            <td colspan="1" class="confluenceTd">250</td><br>            <td colspan="1" class="confluenceTd">600</td><br>            <td colspan="1" class="confluenceTd">20</td><br>            <td colspan="1" class="confluenceTd">1</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">200</td><br>            <td colspan="1" class="confluenceTd">5</td><br>            <td colspan="1" class="confluenceTd">500</td><br>            <td colspan="1" class="confluenceTd">5000</td><br>            <th colspan="1" class="confluenceTh">5140</th><br>            <td colspan="1" class="confluenceTd">8497</td><br>            <td colspan="1" class="confluenceTd">8778</td><br>            <td colspan="1" class="confluenceTd">9076</td><br>            <td colspan="1" class="confluenceTd">15704</td><br>            <td colspan="1" class="confluenceTd">0.00%</td><br>            <td colspan="1" class="confluenceTd">7.12069</td><br>            <td colspan="1" class="confluenceTd">70</td><br>            <td colspan="1" class="confluenceTd">605</td><br>            <th colspan="1" class="confluenceTh">671</th><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd"><span>500m</span></td><br>            <td colspan="1" class="confluenceTd">30.0</td><br>            <td colspan="1" class="confluenceTd">800m</td><br>            <td colspan="1" class="confluenceTd"></td><br>        </tr><br>        </tbody><br>    </table><br></div></p>
<p></p><p style="margin-left: 30.0px;">过程：</p><p></p>
<ol><br>    <li>可以看到单Cassandra节点下，kairosdb查询Cassandra最短耗时已经在2S左右，而集群模式下，kairosdb查询Cassandra的最短耗时在200ms<br>        左右，可以看出在低硬件配置下，Cassandra部署集群模式比单机模式的性能提升很大。<br>    </li><br>    <li>Cassandra刚部署时，查询性能表现优秀，连续写入一个小时数据后，查询性能下降。</li><br>    <li>2-5组发现kairosdb 查询时间正常， 但指标库查询出现超时，经建飞排查，原因是调用kairosdb client时创建的 http连接 最大数量最2，修改为200后，情况好转。<br><br><br><br>  <img src="/2017/12/10/171210/image2017-12-8_11_24_9.png"><br><br>    </li><br>    <li>从测试过程可以看到，部分指标库的查询耗时比kairosdb查Cassandra的耗时长很多，查询kairosdb.datastore.queries_waiting<br>        指标，发现kairosdb存在大量等待线程。如下：<br><br><br><br><img src="/2017/12/10/171210/kairosdb.datastore.queries_waiting.png"><br><br>          <br>修改<br>        kairosdb 的配置：kairosdb.datastore.concurrentQueryThread ，再次查询，依然会有等待的查询线程。<br>据此判断，当查询15个指标时，每个指标耗时在2.5S左右时，此硬件配置下的kairosdb性能已达瓶颈，影响因素为CPU核数。当更改部署kairosdb<br>        机器的核数后，性能得到了提升。<br>    </li><br>    <li>同样的查询条件下，CPU核数与kairosdb 的concurrentQueryThread 参数一致时，性能最优；且该参数只在kairosdb 查Cassandra较慢（2S以上）时，才会产生影响。</li><br></ol><br><h2 id="id-指标库性能测试-五、结论"><br>五、结论</h2><br><h3 id="id-指标库性能测试-1、指标库写性能：">1、指标库写性能：</h3><br><ol><br>    <li>由3、5、6组可知，每分钟请求总量一定的情况下，在未到达瓶颈前，并发线程越多，指标写入量越大。</li><br>    <li>由6、8组可知，本机的机器性能并未成为影响指标写入的因素。</li><br>    <li>由6、7和8、9两组可知，在4核16G单节点Cassandra 配置下，请求数在50W/min 左右时，指标库的gateway 模块接收请求已到达瓶颈，为 <strong>50W /min</strong> 左右。</li><br>    <li>由9、10、11三组可知，在指标写入能力到达瓶颈后，改变并发的线程数，不再产生影响。</li><br>    <li>由9、12组可知，待写入的指标类型量不是影响因素。</li><br>    <li>由15组可知，当指标库写入请求量每分钟到千万级时，会出现redis 内存问题。</li><br>    <li>单指标库、单Cassandra节点下，指标写入能力瓶颈在Cassandra处，为 <strong>80W/min</strong>；<br>多指标库、单Cassandra节点下，指标写入能力瓶颈在Cassandra处，为<br>        <strong>85W/min</strong>；<br>单指标库、多Cassandra节点下，指标写入能力瓶颈为 <strong>100W/min</strong>；<br>多指标库、多Cassandra节点下，指标写入能力瓶颈为<strong><br>            <strong>110W/min</strong></strong>。<br><br><br></li><br></ol><br><p></p><br><p>配置预估：</p><br><p style="margin-left: 30.0px;">假设现场1个资源每15 S上报100个指标，则每分钟上报400个，若采用单节点Cassandra<br>    配置，在redis集群状况良好的情况下，可支持1750个资源左右，考虑到稳定性可酌情减少资源量或增加配置。</p><br><p style="margin-left: 30.0px;"></p><br><h3 id="id-指标库性能测试-2、指标库读性能：">2、指标库读性能：</h3><br><ol><br>    <li>由1、2组可知R12版本指标库在现有配置下，最多支持每分钟30次的查询。</li><br>    <li>由2、3组可知，查询较慢时，每10S钟查询10次，比每5S钟查询5次，查询要快。</li><br>    <li>由2、4组可知，相同的请求量下，同一个指标密集查询2次，比两个指标同时各查一次要慢很多。</li><br>    <li>由1、5组可知，查询的数据量从600到7200，查询的Cassandra row从 77到740，查询耗时基本没有变化，不过Cassandra的资源消耗增加很多。</li><br>    <li>由2、7组可知，kairosdb client 创建的 http连接 最大数量与查询性能十分相关，R13中已调整该参数为200。</li><br>    <li>由6-8、14、15组可知，单Cassandra节点下，指标查询的瓶颈为 <strong>90次/分钟</strong>，且当 指标库的查询耗时 与<br>        kairosdb查Cassandra的耗时相差不大时，可以维持稳定查询状态，否则指标库查询超时会越来越严重。<br>    </li><br>    <li>由8-13、17-19组可知，kairosdb的concurrentQueryThread 参数值与CPU核数一致时，性能最优；且该参数只在kairosdb 查Cassandra较慢（2S以上）时，才会产生影响。</li><br>    <li>由8、16组可知，指标库是否集群模式不是瓶颈。</li><br>    <li>由19、22和20、23两组可知，单kairosdb 8核的查询性能 与双kairosdb 4核基本相同，所以kairosdb 的查询性能与机器的CPU核数有关。</li><br>    <li>由19、24组可知，当前的查询瓶颈在Cassandra 处，Cassandra 集群的查询性能是单节点的10倍。</li><br>    <li>由24-29组可知，Cassandra集群下，查询性能瓶颈为<strong>1400次/分钟</strong>，当查询到1500次/分钟时，kairosdb出现瓶颈，等待查询线程不断增加。</li><br>    <li>由30、31组可知，当Cassandra写入一段时间数据后，指标查询性能下降很多。</li><br></ol>


      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/public/tags/cassandra/" rel="tag"># cassandra</a>
          
            <a href="/public/tags/kairosdb/" rel="tag"># kairosdb</a>
          
            <a href="/public/tags/jmeter/" rel="tag"># jmeter</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/08/171108/" rel="next" title="linux 进程 性能监控">
                <i class="fa fa-chevron-left"></i> linux 进程 性能监控
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/18/2017-12-18-doc/" rel="prev" title="Metric使用">
                Metric使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  







        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="jason song" />
            
              <p class="site-author-name" itemprop="name">jason song</p>
              <p class="site-description motion-element" itemprop="description">创造美好！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://jm.taobao.org/" title="阿里中间件BLOG" target="_blank">阿里中间件BLOG</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#目录-Table-of-Contents"><span class="nav-number">1.</span> <span class="nav-text"> 目录 (Table of Contents)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-FAQ"><span class="nav-number">2.</span> <span class="nav-text">FAQ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-一、测试目的"><span class="nav-number">3.</span> <span class="nav-text">一、测试目的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-二、测试环境"><span class="nav-number">4.</span> <span class="nav-text">二、测试环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-三、测试方法"><span class="nav-number">5.</span> <span class="nav-text">三、测试方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-四、测试结果"><span class="nav-number">6.</span> <span class="nav-text">四、测试结果</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#id-指标库性能测试-写:"><span class="nav-number">6.0.1.</span> <span class="nav-text">写:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#id-指标库性能测试-多节点写:"><span class="nav-number">6.0.2.</span> <span class="nav-text">多节点写:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#id-指标库性能测试-读："><span class="nav-number">6.0.3.</span> <span class="nav-text">    读：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#id-指标库性能测试-五、结论"><span class="nav-number">7.</span> <span class="nav-text">五、结论</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#id-指标库性能测试-1、指标库写性能："><span class="nav-number">7.1.</span> <span class="nav-text">1、指标库写性能：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#id-指标库性能测试-2、指标库读性能："><span class="nav-number">7.2.</span> <span class="nav-text">2、指标库读性能：</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jason song</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'JasonSongHoho',
            repo: 'jasonsonghoho.github.io',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: '17ca6772928121ecd577d36db6af74571116e17c',
            
                client_id: '16a173f15eb20b092e69'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    









  





  

  

  

  
  

  

  

  

</body>
</html>
